---
title: "R Notebook"
output: html_notebook
---

```{r}
suppressPackageStartupMessages({
library(tidyverse)
library(patchwork)
theme_set(theme_bw())
library(tidymodels)
library(arrow)
})
```

# Import Data:

```{r}
Tor_hitting <- read_csv("TOR_batting.csv")
```

```{r}
NHL_draft <- read_csv("nhldraft.csv")
NHL_draft
```

# Cleaning:

```{r}
NHL_draft_clean <- NHL_draft |>
  select(-id) |>
  mutate(points_per_game = points/games_played,
         position = as.factor(position))

group <- function(data, dataframe, group) {
  data_frame <- data |>
    group_by({{ group }}) |>
    summarise(points = sum(points, na.rm = TRUE),
            games_played = sum(games_played, na.rm = TRUE),
            points_per_game = points/games_played)
}
NHL_draft_clean
```

# Split into training, validation and testing data:

```{r}
NHL_split <- 
  initial_validation_split(NHL_draft_clean, prop = c(0.6, 0.2))
  training <- training(NHL_split)
  validation <- validation(NHL_split)
  test <- testing(NHL_split)
NHL_split
```

```{r}
points_year <- training |>
  group(training, year) |>
  filter(year <= 1996)
points_per_game_until_1996 <- points_year |>
  ggplot(aes(x = year, y = points_per_game)) +
  geom_col() +
  geom_smooth(colour = "red", method = "lm", se = FALSE, formula = y ~ x)
points_per_game_until_1996
points_year
```
